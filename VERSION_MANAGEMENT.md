# ç‰ˆæœ¬å·ç®¡ç†è¯´æ˜

## ğŸ“Œ èƒŒæ™¯

é¡¹ç›®çš„ç‰ˆæœ¬å·åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ï¼š
- `package.json`
- `.env` (REACT_APP_VERSION)
- `public/manifest.json`
- `public/manifest.firefox.json`
- `public/manifest.thunderbird.json`

ä¸ºäº†é¿å…æ‰‹åŠ¨æ›´æ–°å¤šä¸ªæ–‡ä»¶çš„éº»çƒ¦ï¼Œç°å·²å®ç°è‡ªåŠ¨åŒ–ç‰ˆæœ¬å·ç®¡ç†æ–¹æ¡ˆã€‚

## âœ¨ è§£å†³æ–¹æ¡ˆ

### å•ä¸€ç‰ˆæœ¬æº

**`package.json` æ˜¯å”¯ä¸€çš„ç‰ˆæœ¬å·æ¥æº**ï¼Œå…¶ä»–æ–‡ä»¶çš„ç‰ˆæœ¬å·ä¼šè‡ªåŠ¨ä» `package.json` åŒæ­¥ã€‚

### è‡ªåŠ¨åŒæ­¥æœºåˆ¶

æ„å»ºæ—¶ä¼šè‡ªåŠ¨åŒæ­¥ç‰ˆæœ¬å·ï¼š

```bash
pnpm build        # æ„å»ºå‰è‡ªåŠ¨åŒæ­¥ç‰ˆæœ¬å·
pnpm build+zip    # æ‰“åŒ…å‰è‡ªåŠ¨åŒæ­¥ç‰ˆæœ¬å·
```

æ‰‹åŠ¨åŒæ­¥ç‰ˆæœ¬å·ï¼š

```bash
pnpm sync-version  # æ‰‹åŠ¨è§¦å‘ç‰ˆæœ¬å·åŒæ­¥
```

## ğŸš€ ç‰ˆæœ¬å·æ›´æ–°æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¿«æ·å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
# è¡¥ä¸ç‰ˆæœ¬æ›´æ–°: 2.0.19 -> 2.0.20
pnpm version:patch

# æ¬¡ç‰ˆæœ¬æ›´æ–°: 2.0.19 -> 2.1.0
pnpm version:minor

# ä¸»ç‰ˆæœ¬æ›´æ–°: 2.0.19 -> 3.0.0
pnpm version:major

# æ‰‹åŠ¨æŒ‡å®šç‰ˆæœ¬å·: è®¾ç½®ä¸º 2.1.0
pnpm version:set -- 2.1.0
```

è¿™äº›å‘½ä»¤ä¼šè‡ªåŠ¨å®Œæˆï¼š
1. âœ… æ›´æ–° `package.json` ä¸­çš„ç‰ˆæœ¬å·
2. âœ… è‡ªåŠ¨åŒæ­¥åˆ°å…¶ä»–æ‰€æœ‰æ–‡ä»¶

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ›´æ–°ï¼ˆä¸æ¨èï¼‰

å¦‚æœä½ æ‰‹åŠ¨ä¿®æ”¹äº† `package.json` çš„ç‰ˆæœ¬å·ï¼Œè®°å¾—è¿è¡Œï¼š

```bash
pnpm sync-version
```

## ğŸ“ å®Œæ•´çš„ç‰ˆæœ¬å‘å¸ƒæµç¨‹

```bash
# 0. æ ¼å¼åŒ–
pnpm format

# 1. æ›´æ–°ç‰ˆæœ¬å·ï¼ˆè‡ªåŠ¨å®Œæˆæ‰€æœ‰æ–‡ä»¶çš„åŒæ­¥ï¼‰
pnpm version:patch

# 2. æ›´æ–° CHANGELOG.mdï¼ˆæ‰‹åŠ¨ç¼–è¾‘ï¼‰
# æ·»åŠ æ–°ç‰ˆæœ¬çš„æ›´æ–°å†…å®¹

# 3. æäº¤æ›´æ”¹
git add .
git commit -m "chore: bump version to 2.0.20"

# 4. æ„å»ºå’Œæ‰“åŒ…ï¼ˆæ„å»ºå‰ä¼šå†æ¬¡ç¡®ä¿ç‰ˆæœ¬å·åŒæ­¥ï¼‰
pnpm build+zip

# 5. æ¨é€ä»£ç 
git push origin dev

# 6. åˆå¹¶åˆ° master
git checkout master
git merge dev

# 7. æ‰“ tag
git tag -a v2.0.20 -m "Release version 2.0.20"
git push origin master v2.0.20

# 8. åˆ‡æ¢å› dev åˆ†æ”¯
git checkout dev
```

## ğŸ› ï¸ ç›¸å…³è„šæœ¬æ–‡ä»¶

- `src/scripts/sync-version.mjs` - ç‰ˆæœ¬å·åŒæ­¥è„šæœ¬
- `src/scripts/update-version.mjs` - ç‰ˆæœ¬å·æ›´æ–°è„šæœ¬

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸è¦æ‰‹åŠ¨ä¿®æ”¹** `.env`ã€`manifest.json` ç­‰æ–‡ä»¶ä¸­çš„ç‰ˆæœ¬å·
2. **åªéœ€ä¿®æ”¹** `package.json` ä¸­çš„ç‰ˆæœ¬å·ï¼Œæˆ–è€…ä½¿ç”¨ `pnpm version:*` å‘½ä»¤
3. æ¯æ¬¡æ„å»ºå‰ä¼šè‡ªåŠ¨åŒæ­¥ç‰ˆæœ¬å·ï¼Œç¡®ä¿æ‰€æœ‰æ–‡ä»¶ç‰ˆæœ¬ä¸€è‡´
4. æ›´æ–°ç‰ˆæœ¬åè®°å¾—åŒæ­¥æ›´æ–° `CHANGELOG.md`
